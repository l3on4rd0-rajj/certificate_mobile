Tabela 1: Threat Actors (Atores de Ameaça)
ID	Descrição
TA01	Dados não criptografados em trânsito
TA02	Interceptação de dados (Man-in-the-Middle)
TA03	APIs expostas sem autenticação adequada
TA04	QR Code Tampering (Alteração maliciosa)
TA05	Replay Attacks (Reutilização do QR Code)
TA06	Injeção de QR Codes falsos
TA07	QR Code sem expiração definida
TA08	Webhook Spoofing (Falsificação)
TA09	Replay de Webhooks
TA10	Perda de Webhooks
TA11	Dados sensíveis em trânsito (Webhooks)
TA12	Falta de validação do payload (Webhooks)
TA13	Logs contendo informações sensíveis
Tabela 2: Security Controls (Mitigações)
ID	Descrição
C01	Validar certificados digitais (TLS/MTLS)
C02	Autenticação mútua (mTLS)
C03	Uso de TLS 1.2+
C04	Implementar Nonce (valores únicos em QR Codes)
C05	Tempo de vida curto para QR Codes
C06	Assinatura digital no QR Code
C07	Criptografia de dados sensíveis em trânsito
C08	Mecanismo de confirmação de recebimento (Webhooks)
C09	Criptografar dados sensíveis em repouso
C10	Validação de payload (Webhooks)
C11	Logs sanitizados (sem dados sensíveis)
Tabela 3: Correlação por Etapa do Fluxo
1. Solicitação do QR Code
Ameaça	Mitigações Aplicáveis
TA03 (APIs expostas)	C01, C02 (mTLS + validação de certificados)
TA01 (Dados não criptografados)	C03 (TLS 1.2+)
2. Exibição do QR Code
Ameaça	Mitigações Aplicáveis
TA04 (QR Code Tampering)	C06 (Assinatura digital)
TA05 (Replay Attacks)	C04 (Nonce), C05 (Expiração curta)
TA06 (Injeção de QR Code)	C06 (Assinatura digital)
TA07 (QR Code sem expiração)	C05 (Tempo de vida curto)
3. Leitura do QR Code
Ameaça	Mitigações Aplicáveis
TA02 (MITM)	C01, C02, C03 (TLS + mTLS)
TA01 (Dados não criptografados)	C07 (Criptografia em trânsito)
4. Solicitação de Pagamento
Ameaça	Mitigações Aplicáveis
TA03 (APIs expostas)	C01, C02 (mTLS)
TA11 (Dados sensíveis em trânsito)	C07 (Criptografia)
5. Resposta do Pagamento (Webhooks)
Ameaça	Mitigações Aplicáveis
TA08 (Webhook Spoofing)	C10 (Validação de payload)
TA09 (Replay de Webhooks)	C04 (Nonce), C08 (Confirmação)
TA10 (Perda de Webhooks)	C08 (Mecanismo de confirmação)
TA12 (Falta de validação)	C10 (Validação de payload)
TA13 (Logs sensíveis)	C11 (Sanitização de logs)
